<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><style type=text/css>body{font-family:monospace}</style><title>iOS Fundamentals Part 2</title><link rel=stylesheet href=/css/style.css></head><body><header>===================<br>== <a href=https://blog.peterchen.xyz/>颢阳's Blog</a> ==<br>===================<div style=float:right>blog for everything</div><br><p><nav><a href=/><b>Start</b></a>.
<a href=/posts/><b>Posts</b></a>.
<a href=/reads/><b>Reads</b></a>.
<a href=/categories/><b>Categories</b></a>.
<a href=/tags/><b>Tags</b></a>.</nav></p><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],['\\[','\\]']],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:['script','noscript','style','textarea','pre']}},window.addEventListener('load',a=>{document.querySelectorAll("mjx-container").forEach(function(a){a.parentElement.classList+='has-jax'})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest></header><main><article><h1>iOS Fundamentals Part 2</h1><b><time>11.15.2017 11:00</time></b>
<a href=/tags/ios>iOS</a><div><h2 id=scene--segues>Scene & Segues</h2><ul><li>Use blocks for communication between scenes (save or cancel)</li><li><code>typedef returntype(^&lt;#block name#>)(&lt;#arguments#>);</code></li><li>block properties should always be <em>copy</em></li><li>Two common styles:<ol><li>Show: left-to-right navigation</li><li>Present Modally: full-screen cover</li></ol></li><li>Use <code>prepareForSegue:</code> to connect<ul><li>Set the completion handler: insert new quote into models; have table view reload data; dismiss view controller</li></ul></li></ul><h2 id=data-persistence>Data Persistence</h2><ol><li>User Default: <code>NSUserDefaults</code> using key value (like <code>NSDictionary</code>)</li><li>Save files to the Document folder using plist</li><li>Use SQLite</li><li>Use Core Data</li></ol><p><em>Folder to save</em></p><ul><li>Documents<ul><li>Your application stores its data in Documents, with the exception of NSUserDefaults-based preference settings</li></ul></li><li>Library<ul><li>NSUserDefaults-based preference settings are stored in the Library/Preferences folder</li></ul></li><li>tmp<ul><li>Place to store temporary files that will not be backed up by iTunes, but your app has to be responsibility for deleting the files</li></ul></li></ul><p><strong>User Defaults</strong></p><ul><li>No high performance</li><li>No complex structure</li><li>Not searchable</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objective-c data-lang=objective-c>NSString <span style=color:#f92672>*</span><span style=color:#66d9ef>const</span> kCurrentIndexKey <span style=color:#f92672>=</span> <span style=color:#e6db74>@&#34;CurrentIndex&#34;</span>;
- (<span style=color:#66d9ef>void</span>) <span style=color:#a6e22e>save</span>{
    NSUserDefaults <span style=color:#f92672>*</span>defaults <span style=color:#f92672>=</span> [NSUserDefaults standardUserDefaults];
    [defaults setObject:[NSNumber numberWithInt:self.currentIndex] forKey:kCurrentIndexKey];
    [defaults synchronize];
}  

- (NSNumber) <span style=color:#a6e22e>read</span> {
  NSNumber <span style=color:#f92672>*</span>readData <span style=color:#f92672>=</span> [[NSUserDefaults standardUserDefaults] objectForKey:kCurrentIndexKey];
  <span style=color:#66d9ef>return</span> readData;
}
</code></pre></div><p><em>Use of const</em></p><ol><li>Prevent mistype</li><li>Convenience to auto-complete</li><li>Declare outside of @interface and @implementation</li></ol><p><strong>Inside Document Folder</strong></p><ul><li>Accept types:<ul><li>Property List (xml)</li><li>Text Files</li><li>Archiving Objects &ndash; <code>NSCoding</code> protocol</li></ul></li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objective-c data-lang=objective-c> NSString <span style=color:#f92672>*</span>documentsDirPath <span style=color:#f92672>=</span> NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES)[<span style=color:#ae81ff>0</span>];
 <span style=color:#75715e>// Create a file name for your file
</span><span style=color:#75715e></span> NSString <span style=color:#f92672>*</span>filename <span style=color:#f92672>=</span> <span style=color:#e6db74>@&#34;flashcards.plist&#34;</span>;
 <span style=color:#75715e>// Generate the full file path
</span><span style=color:#75715e></span> _filePath <span style=color:#f92672>=</span> [NSString stringWithFormat:<span style=color:#e6db74>@&#34;%@/%@&#34;</span>, documentsDirPath, filename];

 NSLog(<span style=color:#e6db74>@&#34;file path %@&#34;</span>, _filePath);

 NSArray <span style=color:#f92672>*</span>flashcardsFromDocumentsDir <span style=color:#f92672>=</span> [[NSArray alloc] initWithContentsOfFile:_filePath];
</code></pre></div><h2 id=app-life-cycle>App life cycle</h2><p><strong>App States</strong></p><ul><li>Not Running</li><li>Inactive (foreground)</li><li>Active (foreground)</li><li>Background</li><li>Suspended</li></ul><h2 id=memory>Memory</h2><p><strong>Two Methods of application memory management</strong></p><ol><li>Manual retain-release: MRR</li><li>Automatic Reference Counting: ARC</li></ol><ul><li>Using reference-count</li><li>Invoke <code>dealloc</code> automatically</li></ul><h3 id=mrr>MRR</h3><p><strong>Cocoa&rsquo;s Policy</strong></p><ul><li>You own object you created: <code>alloc</code> <code>new</code> <code>copy</code> <code>mutableCopy</code></li><li>Take ownership by using <code>retain</code></li><li>When no longer need, relinquish it using <code>release</code> or <code>autorelease</code> (must relinquish object do not own)</li><li>&ldquo;Parent&rdquo; object maintain strong reference to &ldquo;children&rdquo;, &ldquo;children&rdquo; have weak reference to &ldquo;parents&rdquo;</li></ul><p><strong>Pratical Memory Management</strong></p><ul><li>Use accessor methods to set property values</li><li>Don&rsquo;t use accessor methods in initalizer and dealloc</li><li>Use weak reference to avoid retain cycles</li><li>Avoid dealloc object while using</li><li>Don&rsquo;t use dealloc to manage scarce resources</li><li>Collections own the objects they contain</li><li>Ownership policy is implemented using retain counts</li></ul><p><strong>Retain Count</strong></p><ul><li>When create an object, RC (retain count) is 1</li><li>When send a retain message, RC + 1</li><li>When send a release message, RC - 1</li><li>When you send an object a autorelease message, its retain count is decremented by 1 at the end of the current autorelease pool block.</li><li>If RC == 0 -> object dealloc</li></ul><h3 id=arc>ARC</h3><p><em>Insert <code>retains</code> and <code>releases</code> into code when compile</em></p><h2 id=web-view>Web View</h2><p><strong>WebKit</strong></p><ul><li>Follow MVC framework<ul><li>View: <code>WebView</code></li><li>Object: <code>WebFrameView</code> and <code>WebFrame</code></li></ul></li><li>App Transport Security force to connect with web service through HTTPS</li></ul><p>Example:</p><p>Read a pdf file</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objective-c data-lang=objective-c>- (<span style=color:#66d9ef>void</span>)<span style=color:#a6e22e>viewDidLoad</span> {
[super viewDidLoad];
NSString <span style=color:#f92672>*</span>path <span style=color:#f92672>=</span> [[NSBundle mainBundle] pathForResource:<span style=color:#e6db74>@&#34;HIG&#34;</span> ofType:<span style=color:#e6db74>@&#34;pdf&#34;</span>];
<span style=color:#66d9ef>if</span> (path){
NSData <span style=color:#f92672>*</span>pdfData <span style=color:#f92672>=</span> [NSData dataWithContentsOfFile:path];
[(UIWebView <span style=color:#f92672>*</span>)self.view loadData:pdfData MIMEType:<span style=color:#e6db74>@&#34;application/pdf&#34;</span>
textEncodingName:<span style=color:#e6db74>@&#34;utf-8&#34;</span> baseURL:nil];
}
}
</code></pre></div><p>Read a url</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objective-c data-lang=objective-c>NSURL <span style=color:#f92672>*</span>url <span style=color:#f92672>=</span> [NSURL URLWithString:<span style=color:#e6db74>@&#34;https://www.apple.com&#34;</span>];
NSURLRequest <span style=color:#f92672>*</span>request <span style=color:#f92672>=</span> [NSURLRequest requestWithURL:url];
[self.myWebView loadRequest: request];
</code></pre></div><p>Cancel a loading request</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objective-c data-lang=objective-c>- (<span style=color:#66d9ef>void</span>)<span style=color:#a6e22e>viewWillDisappear:</span>(<span style=color:#66d9ef>BOOL</span>)animated{
[super viewWillDisappear:animated];
<span style=color:#66d9ef>if</span> ([self.myWebView isLoading]){
[self.myWebView stopLoading];
}
<span style=color:#75715e>// Disconnect the delegate as the webview is hidden
</span><span style=color:#75715e></span>self.myWebView.delegate <span style=color:#f92672>=</span> nil;
}
</code></pre></div><p>Animation loading in WebView</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objective-c data-lang=objective-c>- (<span style=color:#66d9ef>void</span>)<span style=color:#a6e22e>webViewDidStartLoad:</span>(UIWebView <span style=color:#f92672>*</span>)webView{
[self.activityIndicator startAnimating];
}
- (<span style=color:#66d9ef>void</span>)<span style=color:#a6e22e>webViewDidFinishLoad:</span>(UIWebView <span style=color:#f92672>*</span>)webView{
[self.activityIndicator stopAnimating];
}
- (<span style=color:#66d9ef>void</span>)<span style=color:#a6e22e>webView:</span>(UIWebView <span style=color:#f92672>*</span>)webView <span style=color:#a6e22e>didFailLoadWithError:</span>(NSError <span style=color:#f92672>*</span>)error{
[self.activityIndicator stopAnimating];
}
</code></pre></div><p><em>Notes</em></p><ol><li>A web view automatically converts telephone numbers that appear in web content to Phone links.</li><li>You should not embed <code>UIWebView</code> or <code>UITableView</code> objects in <code>UIScrollView</code> objects.</li></ol><h2 id=table-view-rewind>Table View Rewind</h2><h3 id=modifying-tables>Modifying Tables</h3><p><strong>Delete table cells</strong></p><ul><li>Add navigation control</li><li>Enable edit button in <code>viewDidLoad</code> method</li><li>Use the public remove method in the model</li><li>Implement <code>tableView: commitEditingStyle: forRowAtIndexPath</code> method</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-objective-c data-lang=objective-c>- (<span style=color:#66d9ef>void</span>)<span style=color:#a6e22e>tableView:</span>(UITableView <span style=color:#f92672>*</span>)tableView <span style=color:#a6e22e>commitEditingStyle:</span>(UITableViewCellEditingStyle)editingStyle <span style=color:#a6e22e>forRowAtIndexPath:</span>(NSIndexPath <span style=color:#f92672>*</span>)indexPath {
    <span style=color:#66d9ef>if</span> (editingStyle <span style=color:#f92672>==</span> UITableViewCellEditingStyleDelete) {
        <span style=color:#75715e>// Delete the row from the data source
</span><span style=color:#75715e></span>        [self.model removeFlashcardAtIndex:indexPath.row];
        [tableView deleteRowsAtIndexPaths:<span style=color:#ae81ff>@[</span>indexPath<span style=color:#ae81ff>]</span> withRowAnimation:UITableViewRowAnimationFade];
    } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (editingStyle <span style=color:#f92672>==</span> UITableViewCellEditingStyleInsert) {
        <span style=color:#75715e>// Create a new instance of the appropriate class, insert it into the array, and add a new row to the table view
</span><span style=color:#75715e></span>    }   
}
</code></pre></div></div></article></main><aside><div><div><h3>LATEST POSTS</h3></div><div><ul><li><a href=/posts/why-doordash-cannot-deliver-your-order-properly/>Why DoorDash Cannot Deliver Your Order Properly</a></li><li><a href=/posts/create-responsive-shortcode/>Create Responsive Shortcode</a></li><li><a href=/posts/what-does-it-mean-when-you-turn-25/>What Does It Mean When You Turn 25</a></li><li><a href=/posts/how-do-i-create-this-site/>How Do I Create This Site</a></li><li><a href=/posts/system-design/>System Design</a></li></ul></div></div></aside><footer><p>&copy; 2021 <a href=https://blog.peterchen.xyz/><b>颢阳</b></a>.
<a href=https://github.com/advpetc><b>Github</b></a>.
<a href=/imprint><b>Imprint</b></a>.</p></footer></body></html>